# 東広島基幹相談支援センターの記録管理システム

本システムは以下の通りのシステムで構成されます。

- モバイルデバイス
- PC端末
- 電話接続システム（クラウドPBX）
- 記録管理システムソフトウェア
  - 相談支援文書作成機能
  - 相談支援機能

## 相談支援文書作成機能


## 相談支援機能（AI支援機能）

### 音声録音機能

相談内容を録音する機能を実装します。これにより、相談内容を漏れなく保存し、後から参照することが可能になります。録音は相談記録と紐づけて管理され、必要に応じていつでも聞き返すことができます。

### 文字起こし機能

録音したデータを文字起こしし、テキストデータとして保存します。理想的にはリアルタイムでの文字起こしと障害相談支援に関わるキーワードの抽出が望ましいですが、現状の技術では精度に限界があります。そのため、録音後に高精度な文字起こし処理を行う方式を採用します。

文字起こしされたデータは、文章ごとや約10秒程度の会話で区切り、「時間，文章」という形式のデータ（音声紐づけ文字データ）として一覧表示します。これにより、長時間の録音内容でも容易に内容を把握することができます。

### しおり機能

文字起こしデータの特定箇所に「しおり」を付ける機能を実装します。重要なポイントや後で参照したい箇所などにしおりを設定することで、大量のデータの中から必要な情報をすぐに見つけることができるようになります。

### 音声-テキスト連携再生機能

録音データをプレイヤーと紐づけ、文字起こしされたテキストの任意の箇所をクリックすると、そのあたりのタイムラインから音声を再生できる機能を実装します。これにより、文字だけでは伝わりにくいニュアンスや話し方などの情報も含めて確認することができます。

### 見出し・要約・目次生成機能

文字起こしされたデータから自動で見出し、要約、目次を生成します。これにより、長文の相談内容でも全体像を把握しやすくなり、ユーザビリティが向上します。生成された見出しや要約は編集も可能で、必要に応じてカスタマイズすることができます。

### データアクセス・検索機能

ユーザーは、見出しと録音日時から録音データ・文字起こしデータを選択できます。また、生成された目次から音声紐づけ文字データの一覧を表示することができ、データアクセスが簡便になります。さらに、キーワード検索機能により、大量の相談記録の中から必要な情報をすばやく見つけることが可能になります。

## 録音データから文字起こしデータに変換されるまでのプロセス

```mermaid
sequenceDiagram
    actor 相談員
    participant UI as システムUI
    participant 録音管理 as 録音管理サービス
    participant 音声処理 as 音声処理エンジン
    participant 文字起こし as 文字起こしエンジン
    participant AI処理 as AI分析処理
    participant DB as データベース

    %% 録音開始から終了まで
    相談員->>UI: 録音開始ボタンをクリック
    UI->>録音管理: 録音開始リクエスト
    録音管理->>録音管理: 録音セッション作成
    録音管理->>DB: 録音メタデータ保存
    録音管理-->>UI: 録音開始通知
    UI-->>相談員: 録音中表示
    
    Note over 相談員,UI: 相談中...
    
    相談員->>UI: 録音停止ボタンをクリック
    UI->>録音管理: 録音停止リクエスト
    録音管理->>録音管理: 録音データのファイナライズ
    録音管理->>DB: 録音ファイル情報更新
    録音管理-->>UI: 録音完了通知
    UI-->>相談員: 録音完了表示
    
    %% 文字起こし処理開始
    録音管理->>音声処理: 録音ファイルを処理依頼
    音声処理->>音声処理: 音声ファイルの前処理
    Note right of 音声処理: ノイズ除去、音質調整など
    
    音声処理->>文字起こし: 音声データ送信
    文字起こし->>文字起こし: 文字起こし処理実行
    Note right of 文字起こし: 音声を10秒間隔または<br/>文章単位で区切り

    文字起こし->>AI処理: 文字起こし結果送信
    AI処理->>AI処理: 話者分離処理
    AI処理->>AI処理: タイムスタンプ付与
    
    AI処理->>DB: 文字起こしデータ保存
    
    %% 分析処理
    AI処理->>AI処理: キーワード抽出
    AI処理->>AI処理: 見出し生成
    AI処理->>AI処理: 要約作成
    AI処理->>AI処理: 目次生成
    
    AI処理->>DB: 分析結果データ保存
    DB-->>UI: 処理完了通知
    UI-->>相談員: 文字起こし完了通知
    
    %% 結果確認
    相談員->>UI: 文字起こし結果の確認
    UI->>DB: 文字起こしデータ取得
    DB-->>UI: データ返却
    UI-->>相談員: 音声紐づけ文字データ表示
    
    %% 編集
    相談員->>UI: 文字起こし内容の編集
    UI->>DB: 編集内容を保存
    DB-->>UI: 保存完了通知
    UI-->>相談員: 保存完了表示
```
